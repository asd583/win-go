<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Wingo Game</title>
<style>
body { font-family: Arial, sans-serif; background:#111; color:white; text-align:center; margin:0; padding:0; }
header { background:#00ffc3; color:#111; padding:10px; font-size:1.2rem; font-weight:bold; }
h1 { margin:20px 0; color:#00ffc3; }
#balance { margin:15px 0; font-size:1.2rem; }
button { border:none; border-radius:15px; padding:12px 25px; margin:5px; font-size:1rem; cursor:pointer; transition:0.2s; }
button:hover { transform:scale(1.05); }
.big { background:#ff4d4d; } .small { background:#4d79ff; }
.red { background:#ff1a1a; } .green { background:#33cc33; } .purple { background:#9933ff; }
.number { background:#ffaa00; color:#111; }
#timer { font-size:2rem; margin:10px; }
#betSection, #resultSection { margin:15px auto; width:95%; max-width:600px; padding:15px; background:#222; border-radius:15px; }
#history ul { list-style:none; padding:0; max-height:150px; overflow-y:auto; }
#history li { background:#333; margin:3px 0; padding:5px 10px; border-radius:10px; text-align:left; }
.slide { animation:slideUp 0.5s forwards; }
@keyframes slideUp { from {transform:translateY(100%);} to {transform:translateY(0);} }
</style>
</head>
<body>

<header id="welcome"></header>
<h1>Wingo Game</h1>
<div id="balance"></div>

<div id="betSection">
  <label>Bet Amount: <input type="number" id="betAmount" value="50000" min="30000"></label>
  <div id="timer">30</div>

  <h2>Predict Size</h2>
  <button class="big" onclick="placeBet('Big')">Big</button>
  <button class="small" onclick="placeBet('Small')">Small</button>

  <h2>Predict Color</h2>
  <button class="red" onclick="placeBet('Red')">Red</button>
  <button class="green" onclick="placeBet('Green')">Green</button>
  <button class="purple" onclick="placeBet('Purple')">Purple</button>

  <h2>Predict Number (0-9)</h2>
  <div id="numbers"></div>
</div>

<div id="resultSection">
  <div id="result"></div>
  <div id="history">
    <h3>Last 10 Outcomes:</h3>
    <ul id="historyList"></ul>
  </div>
</div>

<script>
// --- Initialization ---
let player = localStorage.getItem('currentUser');
if(!player){ window.location.href="signin.html"; }
document.getElementById('welcome').textContent = `Welcome, ${player}!`;

let balance = parseInt(localStorage.getItem(player+'_balance')||'100000');
let userBet = null;
let betAmount = 50000;
let countdown = 30;
let historyArr = [];

initNumbers();
updateBalance();
startTimer();

// --- Functions ---
function initNumbers(){
  const container = document.getElementById('numbers');
  container.innerHTML = '';
  for(let i=0;i<=9;i++){
    const btn = document.createElement('button');
    btn.textContent = i;
    btn.className='number';
    btn.onclick = ()=>placeBet(i);
    container.appendChild(btn);
  }
}

function updateBalance(){
  document.getElementById('balance').textContent = `Balance: ${balance.toLocaleString()} MMK`;
  localStorage.setItem(player+'_balance', balance);
}

function placeBet(choice){
  betAmount = parseInt(document.getElementById('betAmount').value) || 30000;
  if(betAmount < 30000){ alert("Minimum bet is 30,000 MMK"); return; }
  if(betAmount > balance){ alert("Insufficient balance"); return; }
  userBet = choice;
  document.getElementById('result').textContent = `You bet ${betAmount.toLocaleString()} MMK on ${choice}`;
  document.getElementById('resultSection').classList.add('slide');
}

function startTimer(){
  setInterval(()=>{
    document.getElementById('timer').textContent = countdown;
    countdown--;
    if(countdown<0){
      countdown=30;
      playRound();
    }
  },1000);
}

function playRound(){
  const sizes=['Big','Small'];
  const colors=['Red','Green','Purple'];
  const numbers=[0,1,2,3,4,5,6,7,8,9];

  const sizeResult = sizes[Math.floor(Math.random()*sizes.length)];
  const colorResult = colors[Math.floor(Math.random()*colors.length)];
  const numberResult = numbers[Math.floor(Math.random()*numbers.length)];

  let win=false;
  if(userBet===sizeResult || userBet===colorResult || userBet===numberResult) win=true;
  if(win) balance += betAmount; else balance -= betAmount;
  updateBalance();

  historyArr.unshift({size:sizeResult, color:colorResult, number:numberResult, win});
  if(historyArr.length>10) historyArr.pop();
  renderHistory();

  // Save for admin
  const allBets = JSON.parse(localStorage.getItem('bets')||'[]');
  allBets.push({
    player, bet:userBet, amount:betAmount,
    size:sizeResult, color:colorResult, number:numberResult,
    win, timestamp:new Date().toLocaleString(), balance
  });
  localStorage.setItem('bets', JSON.stringify(allBets));

  document.getElementById('result').textContent=
    `Round Result → Size: ${sizeResult}, Color: ${colorResult}, Number: ${numberResult}. ${win?'WIN!':'LOSE!'}`;
  userBet=null;
}

function renderHistory(){
  const ul = document.getElementById('historyList');
  ul.innerHTML='';
  historyArr.forEach(h=>{
    const li=document.createElement('li');
    li.textContent=`Size:${h.size}, Color:${h.color}, Number:${h.number} → ${h.win?'WIN':'LOSE'}`;
    ul.appendChild(li);
  });
}
</script>
</body>
</html>