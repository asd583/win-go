<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Wingo Game - Player</title>
<style>
body { font-family: Arial, sans-serif; background:#111; color:white; text-align:center; margin:0; padding:0; }
input, button { padding:8px; margin:5px; border-radius:5px; border:none; cursor:pointer; }
button { margin:3px; }
.container { padding:20px; }
.number-grid { display:flex; flex-wrap:wrap; justify-content:center; margin-top:10px; }
.number-grid button {
    width:60px; height:60px; border-radius:50%; margin:5px; font-weight:bold; font-size:1.2rem;
    box-shadow:0 0 8px 3px rgba(255,255,255,0.5); transition: transform 0.2s, box-shadow 0.2s; border:none; cursor:pointer; color:white; border:2px solid #fff;
}
.number-grid button:hover { transform: scale(1.1); box-shadow:0 0 12px 4px rgba(255,255,255,0.7); }
</style>
</head>
<body>

<div class="container" id="loginDiv">
  <h2>Login</h2>
  <input type="text" id="username" placeholder="Email / Phone"><br>
  <input type="password" id="password" placeholder="Password"><br>
  <button id="loginBtn">Login</button>
</div>

<div class="container hidden" id="playerDiv">
  <h2>Wingo Game</h2>
  <div id="balance"></div>
  <h3>Add Bet</h3>
  <div>
    <button onclick="addBet(10)">+10</button>
    <button onclick="addBet(100)">+100</button>
    <button onclick="addBet(1000)">+1000</button>
    <button onclick="addBet(10000)">+10000</button>
  </div>
  <div id="currentBet">Current Bet: 0 MMK</div>
  <div id="timer">30</div>
  <h3>Predict Size</h3>
  <button onclick="placeBet('Big')">Big</button>
  <button onclick="placeBet('Small')">Small</button>
  <h3>Predict Color</h3>
  <button onclick="placeBet('Red')">Red</button>
  <button onclick="placeBet('Green')">Green</button>
  <button onclick="placeBet('Purple')">Purple</button>
  <h3>Predict Number</h3>
  <div id="numbers" class="number-grid"></div>
  <div id="resultSection"></div>
  <div id="historyDiv">
    <h3>Last 10 Outcomes</h3>
    <ul id="historyList"></ul>
  </div>
</div>

<script>
// Global variables
let currentUser='', balance=100000, userBet=null, currentBetAmount=0, bettingStopped=false;
let historyArr=[], roundCount=0, lastNumber=null, lastColor=null, numberSerial=0, colorSerial=0;
let nextRound={};

// Login
document.getElementById('loginBtn').addEventListener('click', function(){
    const username=document.getElementById('username').value.trim();
    const password=document.getElementById('password').value.trim();
    if(!username || !password){ alert("Enter username/password"); return; }

    currentUser=username;
    if(!localStorage.getItem(currentUser+'_balance')) localStorage.setItem(currentUser+'_balance',100000);
    balance=parseInt(localStorage.getItem(currentUser+'_balance'));

    document.getElementById('loginDiv').classList.add('hidden');
    document.getElementById('playerDiv').classList.remove('hidden');

    initPlayer();
});

function initPlayer(){
    updateBalance();
    initNumbers();
    generateNextRound();
    startRoundClock();
    setInterval(checkDailyReset,60000);
}

function updateBalance(){
    document.getElementById('balance').textContent=`Balance: ${balance.toLocaleString()} MMK`;
    localStorage.setItem(currentUser+'_balance',balance);
}

function addBet(amount){
    if(bettingStopped){ alert("Betting closed"); return; }
    currentBetAmount+=amount;
    document.getElementById('currentBet').textContent=`Current Bet: ${currentBetAmount.toLocaleString()} MMK`;
}

function placeBet(choice){
    if(bettingStopped){ alert("Betting closed"); return; }
    let betAmount=currentBetAmount;
    if(betAmount<30000){ alert("Minimum bet 30,000"); return; }
    if(betAmount>balance){ alert("Insufficient balance"); return; }
    userBet=choice;
    document.getElementById('resultSection').textContent=`You bet ${betAmount.toLocaleString()} on ${choice}`;
}

function initNumbers(){
    const container=document.getElementById('numbers'); container.innerHTML='';
    for(let i=0;i<=9;i++){
        const btn=document.createElement('button'); btn.textContent=i;
        if(i===0) btn.style.background='linear-gradient(135deg, red 50%, rebeccapurple 50%)';
        else if(i>=1 && i<=4) btn.style.background='red';
        else if(i===5) btn.style.background='linear-gradient(135deg, green 50%, rebeccapurple 50%)';
        else btn.style.background='green';
        btn.onclick=()=>placeBet(i); container.appendChild(btn);
    }
}

// Timer & rounds
function getMyanmarTime(){ return new Date(new Date().getTime()+6.5*3600*1000); }
function getRoundCountdown(){
    const mmt=getMyanmarTime();
    const startDay=new Date(mmt); startDay.setHours(6,30,0,0);
    let diffSec=Math.floor((mmt-startDay)/1000);
    let countdown=30-(diffSec%30); if(countdown===0) countdown=30;
    return countdown;
}
function startRoundClock(){
    const timerEl=document.getElementById('timer');
    function updateTimer(){
        const countdown=getRoundCountdown(); timerEl.textContent=countdown;
        bettingStopped=countdown<=7;
        if(countdown===1){ currentBetAmount=0; document.getElementById('currentBet').textContent=`Current Bet: 0 MMK`; playRound(); }
    }
    updateTimer(); setInterval(updateTimer,1000);
}

function generateNextRound(){
    const sizes=['Big','Small'], colors=['Red','Green','Purple'], numbers=[0,1,2,3,4,5,6,7,8,9];
    nextRound={ size: sizes[Math.floor(Math.random()*sizes.length)],
                color: colors[Math.floor(Math.random()*colors.length)],
                number: numbers[Math.floor(Math.random()*numbers.length)] };
}

function playRound(){
    roundCount++;
    const sizeResult=nextRound.size, colorResult=nextRound.color, numberResult=nextRound.number;
    generateNextRound();

    if(numberResult===lastNumber) numberSerial++; else { numberSerial=1; lastNumber=numberResult; }
    if(colorResult===lastColor) colorSerial++; else { colorSerial=1; lastColor=colorResult; }

    let win=false;
    let betAmount=currentBetAmount;
    if(userBet===sizeResult || userBet===colorResult || userBet===numberResult) win=true;
    if(win) balance+=betAmount; else balance-=betAmount;
    updateBalance();

    historyArr.unshift({round:roundCount,size:sizeResult,color:colorResult,number:numberResult,win,userBet,amount:betAmount,numberSerial,colorSerial});
    if(historyArr.length>10) historyArr.pop();
    renderHistory();

    userBet=null;
}

function renderHistory(){
    const ul=document.getElementById('historyList'); ul.innerHTML='';
    historyArr.forEach(h=>{
        const li=document.createElement('li');
        li.textContent=`Round ${h.round}: Bet:${h.userBet} Amt:${h.amount.toLocaleString()} â†’ Size:${h.size}, Color:${h.color}, Number:${h.number}`;
        ul.appendChild(li);
    });
}

function checkDailyReset(){
    const mmt=getMyanmarTime();
    if(mmt.getHours()===6 && mmt.getMinutes()===30){
        historyArr=[]; roundCount=0; numberSerial=0; colorSerial=0; lastNumber=null; lastColor=null;
        renderHistory();
    }
}
</script>

</body>
  </html>
